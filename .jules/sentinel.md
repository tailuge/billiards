## 2025-05-14 - XSS in Chat and Notifications
**Vulnerability:** The application was vulnerable to Cross-Site Scripting (XSS) because it used `innerHTML` to render chat messages and game notifications that included user-controlled data (like player names from the session).
**Learning:** Legacy code often uses `innerHTML` for convenience when building complex UI components, but this creates a massive security risk if any part of the message is untrusted. Even system-generated links were being passed as HTML strings through the chat system.
**Prevention:** Always prefer `textContent` for user-controllable text. For cases where HTML is absolutely required (like system links), use a strict parser/regex to extract safe parts and rebuild the elements manually using `createElement`. Ensure `javascript:`, `data:`, and `vbscript:` URIs are blocked by checking for the prefix on trimmed, lowercase strings. Avoid `setAttribute("style")` with dynamic content; instead, parse and set individual style properties (e.g., `a.style.color`).
